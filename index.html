<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="description" content="Prodial Delivery" />
	
	<!-- Favicon icon -->
	<link rel="icon" href="assets/images/favicon.ico" type="image/x-icon">
	<!-- fontawesome icon -->
	<link rel="stylesheet" href="assets/fonts/fontawesome/css/fontawesome-all.min.css">
	<!-- animation css -->
	<link rel="stylesheet" href="assets/plugins/animation/css/animate.min.css">

	<!-- vendor css -->
	<link rel="stylesheet" href="assets/css/style.css">
	<title>Prodial - Food Delivery</title>
	<style>
        .h-img{
            height: 50px;
        }
		.c-img{
            height: 100px;
			border-radius: 10%;
        }
    </style>
	<script>
		try {
			  const cookieValue = document.cookie
			  .split('; ')
			  .find(row => row.startsWith('user='))
			  .split('=')[1];
				console.log(cookieValue);
				if(cookieValue==""){
					window.location.href = "login";
				}
			}
			catch(err) {
			  window.location.href = "login";
			}
	</script>
	<link rel="stylesheet" type="text/css" href="https://unpkg.com/slick-loader@1.1.20/slick-loader.min.css">
    <script src="https://unpkg.com/slick-loader@1.1.20/slick-loader.min.js"></script>  
</head>

<body class="">
	<!-- [ Pre-loader ] start -->
	<div class="loader-bg">
		<div class="loader-track">
			<div class="loader-fill"></div>
		</div>
	</div>
	<!-- [ Pre-loader ] End -->

	<!-- [ navigation menu ] start -->
	<nav class="pcoded-navbar menupos-fixed menu-light brand-blue ">
		<div class="navbar-wrapper ">
			<div class="navbar-brand header-logo bg-c-yellow">
				<a href="index" class="b-brand">
					<img class="h-img" src="assets/images/logo.png" alt="" class="logo images">
				</a>
				<a class="mobile-menu" id="mobile-collapse" href="#!"><span></span></a>
			</div>
			<div class="navbar-content scroll-div">
				<ul class="nav pcoded-inner-navbar">
					<li class="nav-item pcoded-menu-caption">
						<label>Navigation</label>
					</li>
					<li class="nav-item">
						<a href="index" class="nav-link"><span class="pcoded-micon"><i class="feather icon-home"></i></span><span class="pcoded-mtext">Dashboard</span></a>
					</li>
					<li class="nav-item">
						<a href="user" class="nav-link"><span class="pcoded-micon"><i class="feather icon-user"></i></span><span class="pcoded-mtext">Users</span></a>
					</li>
					<li class="nav-item">
						<a href="orders" class="nav-link"><span class="pcoded-micon"><i class="feather icon-shopping-cart"></i></span><span class="pcoded-mtext">Orders</span></a>
					</li>
                    <li class="nav-item">
						<a href="restaurant" class="nav-link"><span class="pcoded-micon"><i class="feather icon-home"></i></span><span class="pcoded-mtext">Restaurants</span></a>
					</li>
                    <li class="nav-item">
						<a href="category" class="nav-link"><span class="pcoded-micon"><i class="feather icon-tag"></i></span><span class="pcoded-mtext">Categories</span></a>
					</li>
					<li class="nav-item">
						<a href="product" class="nav-link"><span class="pcoded-micon"><i class="feather icon-briefcase"></i></span><span class="pcoded-mtext">Products</span></a>
					</li>
					<li class="nav-item">
						<a href="coupon" class="nav-link"><span class="pcoded-micon"><i class="feather icon-box"></i></span><span class="pcoded-mtext">Coupons</span></a>
					</li>
					<li class="nav-item">
						<a href="offer" class="nav-link"><span class="pcoded-micon"><i class="feather icon-percent"></i></span><span class="pcoded-mtext">Offers</span></a>
					</li>
					<li class="nav-item">
						<a href="rider" class="nav-link"><span class="pcoded-micon"><i class="feather icon-shopping-cart"></i></span><span class="pcoded-mtext">Rider</span></a>
					</li>
					<li class="nav-item">
						<a href="notif" class="nav-link"><span class="pcoded-micon"><i class="feather icon-bell"></i></span><span class="pcoded-mtext">Notification</span></a>
					</li>
					<li class="nav-item">
						<a href="logout" class="nav-link"><span class="pcoded-micon"><i class="feather icon-lock"></i></span><span class="pcoded-mtext">Logout</span></a>
					</li>
				</ul>
				<div class="card text-center">
					<div class="card-block">
						<!-- <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button> -->
						<!-- <i class="fas fas-file-code f-40"></i> -->
						<i class="fas fa-laptop-code f-40"></i>
						<h5 class="mt-3">Admin Panel</h5>
						<p>Designed and Developed by experts at D.Tech, Bangalore</p>
						<a href="https://dtechblr.in/" target="_blank" class="btn btn-gradient-primary btn-sm text-white m-0">Visit Us</a>
					</div>
				</div>
			</div>
		</div>
	</nav>
	<!-- [ navigation menu ] end -->

	<!-- [ Header ] start -->
	
	<!-- [ Header ] end -->

	<!-- [ Main Content ] start -->
	<div class="pcoded-main-container">
		<div class="pcoded-wrapper">
			<div class="pcoded-content">
				<div class="pcoded-inner-content">
					<div class="main-body">
						<div class="page-wrapper">
							<!-- [ breadcrumb ] start -->
							<div class="page-header">
								<div class="page-block">
									<div class="row align-items-center">
										<div class="col-md-12">
											<div class="page-header-title">
												<h5>Home</h5>
											</div>
											<ul class="breadcrumb">
												<li class="breadcrumb-item"><a href="index"><i class="feather icon-home"></i></a></li>
												<li class="breadcrumb-item"><a href="#!">Analytics Dashboard</a></li>
											</ul>
										</div>
									</div>
								</div>
							</div>
							<!-- [ breadcrumb ] end -->
							<!-- [ Main Content ] start -->
							<div class="row">

								<!-- product profit start -->
								<div class="col-xl-3 col-md-6"><a href="user">
									<div class="card prod-p-card bg-c-red">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Users</h6>
													<h3 class="m-b-0 text-white"  id="users"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-user text-c-red f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
								<div class="col-xl-3 col-md-6"><a href="category">
									<div class="card prod-p-card bg-c-blue">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Categories</h6>
													<h3 class="m-b-0 text-white" id="category"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-database text-c-blue f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
								<div class="col-xl-3 col-md-6"><a href="product">
									<div class="card prod-p-card bg-c-green">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Products</h6>
													<h3 class="m-b-0 text-white"  id="product"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-dollar-sign text-c-green f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
								<div class="col-xl-3 col-md-6"><a href="orders">
									<div class="card prod-p-card bg-c-yellow">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Orders</h6>
													<h3 class="m-b-0 text-white"  id="orders"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-shopping-basket text-c-yellow f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
								<div class="col-xl-3 col-md-6"><a href="coupon">
									<div class="card prod-p-card bg-c-green">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Coupons</h6>
													<h3 class="m-b-0 text-white"  id="coupon"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-tags text-c-green f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
								<div class="col-xl-3 col-md-6"><a href="restaurant">
									<div class="card prod-p-card bg-c-red">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Restaurants</h6>
													<h3 class="m-b-0 text-white"  id="restaurant"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-home text-c-red f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
								<div class="col-xl-3 col-md-6"><a href="rider">
									<div class="card prod-p-card bg-c-yellow">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Riders</h6>
													<h3 class="m-b-0 text-white"  id="rider"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-motorcycle text-c-yellow f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
								<div class="col-xl-3 col-md-6"><a href="user">
									<div class="card prod-p-card bg-c-blue">
										<div class="card-body">
											<div class="row align-items-center m-b-25">
												<div class="col">
													<h6 class="m-b-5 text-white">Earnings</h6>
													<h3 class="m-b-0 text-white"  id="earning"></h3>
												</div>
												<div class="col-auto">
													<i class="fas fa-dollar-sign text-c-blue f-18"></i>
												</div>
											</div>
											<p class="m-b-0 text-white">Updated Recently</p>
										</div>
									</div></a>
								</div>
							</div>
							<div class="row">
								<div class="col-md-6 col-xl-4">
									<div class="card user-card">
										<div class="card-header">
											<h5>Carousal Images</h5>
										</div>
										<div class="card-body table-border-style">
                                            <div class="table-responsive" style="max-height: 450px; overflow-y: scroll;">
                                                <table id="user" class="table table-hover">
                                                    
                                                </table>
                                            </div>
                                        </div>
									</div>
								</div>
								<div class="col-md-6 col-xl-3">
									<div class="card user-card">
										<div class="card-header">
											<h5>Carousal Images</h5>
										</div>
										<div class="card-body table-border-style">
                                            <div class="table-responsive" style="overflow-x: hidden;">
                                                <form>
													<div class="form-group">
														<label>Carousal Image</label>
														<input id="rlogo" type="file" class="form-control" placeholder="Restaurant Banner" required>
													</div>
													<br>
													<button id="rsave" style="width: 100%;" type="button" class="btn btn-success" data-toggle="tooltip">Add Carousal Image</button>
												</form>
                                            </div>
                                        </div>
									</div>
									<div class="card user-card">
										<div class="card-header">
											<span><h5>Delivery Charge </h5><h3 style="float: right;" id="ch"></h3></span>
										</div>
										<div class="card-body table-border-style">
                                            <div class="table-responsive" style="overflow-x: hidden;">
                                                <form>
													<div class="form-group">
														<label>Update Delivery Charge</label>
														<input id="charge" type="number" class="form-control" placeholder="Delivery Charge" required>
													</div>
													<br>
													<button id="savec" style="width: 100%;" type="button" class="btn btn-warning" data-toggle="tooltip">Update</button>
												</form>
                                            </div>
                                        </div>
									</div>
								</div>
								<div class="col-md-6 col-xl-3">
									<div class="card user-card">
										<div class="card-header">
											<span><h5>Refer Coupon </h5><h4 style="float: right;" id="code"></h4></span>
										</div>
										<div class="card-body table-border-style">
                                            <div class="table-responsive" style="overflow-x: hidden;">
                                                <form>
													<div class="form-group">
														<label>Select Default Refer Coupon</label>
														<select id="codes" class="form-control">
														</select>
													</div>
													<br>
													<button id="savecode" style="width: 100%;" type="button" class="btn btn-primary" data-toggle="tooltip">Save</button>
												</form>
                                            </div>
                                        </div>
									</div>
									<div class="card user-card">
										<div class="card-header">
											<h5>Profile</h5>
										</div>
										<div class="card-body">
											<form>
												<div class="form-group">
                                                    <label>Username</label>
                                                    <input id="un" type="text" class="form-control" placeholder="Username" required>
                                                </div>
												<div class="form-group">
                                                    <label>Password</label>
													<input id="password" type="password" class="form-control" placeholder="Password">
                                                </div><br>
												<button id="savep" style="width: 100%;" type="button" class="btn btn-secondary" data-toggle="tooltip">Save</button>
											</form>
										</div>
									</div>
								</div>
								<div class="col-md-6 col-xl-3">
								
								</div>
							</div>
							<!-- [ Main Content ] end -->
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- [ Main Content ] end -->
	<!-- Required Js -->
	<script src="assets/js/vendor-all.min.js"></script>
	<script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
	<script src="assets/js/pcoded.min.js"></script>

	<script>
		function addRowHandlers() {
            var table = document.getElementById("user");
            var rows = table.getElementsByTagName("tr");
            for (i = 0; i < rows.length; i++) {
                var currentRow = table.rows[i];
                
                if(i>0){
                    var del = currentRow.getElementsByTagName("td")[2].getElementsByTagName("button")[0];
                    var deleteHandler = function(row) {
                        return function() {
                            var id =  row.getElementsByTagName("td")[3].textContent;
                            var fd = new FormData();
                            fd.append('delete',id);
                            
                            $.ajax({
                                url: "https://prodial.dtechblr.in/api/carousal.php",
                                type: 'post',
                                data: fd,
                                contentType: false,
                                processData: false,
                                success: function(response){
                                    console.log(response);
                                    window.location.reload();
                                }
                            });
                        };
                    };
                    del.onclick = deleteHandler(currentRow);
                }
            }
        }

		$(document).ready(function () {
            SlickLoader.enable();
            var str="<thead><tr><th>#</th><th>Image</th><th>Action</th><th style='display:none;'>ID</th></tr></thead><tbody>";
			$.ajax({
				type: 'GET',
				url: 'https://prodial.dtechblr.in/api/carousal.php',
				dataType: 'json',
				success: function(response){
					console.log(response.success);
					if(response.success){
						$.each(response.carousel, function(index,item){
							var link = item['image'];
                            link = link.split(' ').join('%20');
							console.log(link);
							str=str+ "<tr><td><h5>"+(index+1)+"</h5></td><td><img loading='lazy' class='c-img' src='"+link+"'></td><td><button type='button' class='btn btn-outline-danger' data-toggle='tooltip'>Delete</button></td><td style='display:none;'>"+item['id']+"</td></tr>";
						})
						SlickLoader.disable();
						document.getElementById("user").innerHTML = str+"</tbody>";
					}
					else{
						console.log(response.message);
					}
					addRowHandlers();
				}
			});

			$.ajax({
				type: 'GET',
				url: 'https://prodial.dtechblr.in/api/counts.php',
				dataType: 'json',
				success: function(response){
					console.log(response.success);
					if(response.success){
						document.getElementById('restaurant').innerHTML= response.restaurant;
						document.getElementById('users').innerHTML= response.user;
						document.getElementById('coupon').innerHTML= response.coupon;
						document.getElementById('category').innerHTML= response.category;
						document.getElementById('orders').innerHTML= response.orders;
						document.getElementById('product').innerHTML= response.product;
						document.getElementById('rider').innerHTML= response.rider;
						document.getElementById('earning').innerHTML= "₹ "+response.earning;
					}
				}
			});

			$.ajax({
				type: 'GET',
				url: 'https://prodial.dtechblr.in/api/profile.php',
				dataType: 'json',
				success: function(response){
					console.log(response.success);
					if(response.success){
						document.getElementById('un').value= response.username;
						document.getElementById('password').value= response.password;
					}
				}
			});

			document.getElementById("savep").onclick= function() {
                SlickLoader.enable();

				var unm = document.getElementById('un').value;
				var ped =document.getElementById('password').value;

				var fd = new FormData();
                fd.append('username',unm);
				fd.append('password',ped);

				$.ajax({
					type: 'POST',
					url: 'https://prodial.dtechblr.in/api/profile.php',
					data: fd,
					contentType: false,
                    processData: false,
					success: function(response){
						console.log(response.success);
						if(response.success){
							window.location.reload();
						}
						SlickLoader.disable();
					}
				});
			}

			$.ajax({
				type: 'GET',
				url: 'https://prodial.dtechblr.in/api/delivery_charge.php',
				dataType: 'json',
				success: function(response){
					console.log(response.success);
					if(response.success){
						document.getElementById("ch").innerHTML = " ₹ "+response.charge;
						document.getElementById("code").innerHTML = response.rcid;
					}
				}
			});
			var str2="<option value='0'>Select a Coupon</option>";
			$.ajax({
                type: 'GET',
                url: 'https://prodial.dtechblr.in/api/coupon.php',
                dataType: 'json',
                success: function(response){
                    console.log(response.success);
                    if(response.success){
                        $.each(response.data, function(index,item){
                            str2 = str2 + "<option value='"+item.id+"'>"+item.code+"</option>";
                        })
						
                        document.getElementById("codes").innerHTML = str2;
                    }
                    else{
                        console.log(response.message);
                    }
                    SlickLoader.disable();
                }
            });

			document.getElementById("rsave").onclick= function() {
                SlickLoader.enable();
                var file= $('#rlogo')[0].files[0];
                var fd = new FormData();
                fd.append('file',file);
                
                $.ajax({
                    url: "https://prodial.dtechblr.in/api/carousal.php",
                    type: 'post',
                    data: fd,
                    contentType: false,
                    processData: false,
                    success: function(response){
                        window.location.reload();
                    }
                });
            };
			document.getElementById("savec").onclick= function() {
                SlickLoader.enable();
                var c = document.getElementById("charge").value;
				if(c==""){
					alert("Please Enter some value");
					SlickLoader.disable();
					return;
				}
                var fd = new FormData();
                fd.append('dc',c);
                
                $.ajax({
                    url: "https://prodial.dtechblr.in/api/delivery_charge.php",
                    type: 'post',
                    data: fd,
                    contentType: false,
                    processData: false,
                    success: function(response){
                        window.location.reload();
                    }
                });
            };

			document.getElementById("savecode").onclick= function() {
                SlickLoader.enable();
                var c = document.getElementById("codes").value;
				if(c==0){
					alert("Please Select a code");
					SlickLoader.disable();
					return;
				}
                var fd = new FormData();
                fd.append('rcode',c);
                
                $.ajax({
                    url: "https://prodial.dtechblr.in/api/delivery_charge.php",
                    type: 'post',
                    data: fd,
                    contentType: false,
                    processData: false,
                    success: function(response){
                        window.location.reload();
                    }
                });
            };

        });
	</script>
</body>

</html>
